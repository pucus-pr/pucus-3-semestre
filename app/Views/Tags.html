<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tags</title>
    <link rel="stylesheet" href="./css/generalStyle.css">
</head>
<body>
    <div class="goo">
        <div class="voltar">
            <a href="/Feed">Voltar</a>
        </div>
        <div class="palito">
            <h2>Adicionar Nova Tag</h2>
        <form id="createTagForm" method="post" onsubmit="return createTag();">
            <div class="inputs">
              <label for="createNome">Nome</label>
              <input type="text" id="createNome" name="name" required>
            </div>
            <button class="button" type="submit">Confirmar Adição</button>
        </form>
    
        <br><br>
    
        <h2>Editar Tag</h2>
        <form id="editTagForm" method="post" onsubmit="return editTag();">
            <div class="inputs">
                <label for="editId">ID</label>
                <input type="text" id="editId" name="id" required>
            </div>
            <div class="inputs">
                <label for="editNome">Nome</label>
                <input type="text" id="editNome" name="name" required>
            </div>
            <button class="button" type="submit">Confirmar Edição</button>
        </form>
    
        <br><br>
    
        <h2>Excluir Tag</h2>
        <form id="deleteTagForm" method="post" onsubmit="return removeTag();">
            <div class="inputs">
                <label for="deleteId">ID</label>
                <input type="text" id="deleteId" name="id" required>
            </div>
            <button class="button" type="submit">Confirmar Exclusão</button>
        </form>
    
        <br><br>
    
        <h2>Consultar Tag</h2>
        <form id="getTagForm" method="post" onsubmit="return getTag();">
            <div class="inputs">
                <label for="getId">ID</label>
                <input type="text" id="getId" name="id" required>
            </div>
            <button class="button" type="submit">Buscar</button>
        </form>
    
        <script>
            async function createTag() {
                const form = new FormData(document.getElementById("createTagForm"));
                const response = await fetch('/api/tags', {
                    method: 'POST',
                    body: form
                });
    
                const data = await response.json();
                alert(data.message);
                return false;
            }
    
            async function editTag() {
                const form = new FormData(document.getElementById("editTagForm"));
                const id = form.get('id');
                const formData = new URLSearchParams(form);
    
                const response = await fetch(`/api/tags/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: formData
                });
    
                const data = await response.json();
                alert(data.message);
                return false;
            }
    
            async function removeTag() {
                const form = new FormData(document.getElementById("deleteTagForm"));
                const id = form.get('id');
    
                const response = await fetch(`/api/tags/${id}`, {
                    method: 'DELETE'
                });
    
                const data = await response.json();
                alert(data.message);
                return false;
            }
    
            async function getTag() {
                const form = new FormData(document.getElementById("getTagForm"));
                const id = form.get('id');
    
                const response = await fetch(`/api/tags/${id}`, {
                    method: 'GET'
                });
    
                const data = await response.json();
    
                if (response.ok) {
                    let output = 'Informações:\n';
                    for (const key in data[0]) {
                        output += `${key}: ${data[0][key]}\n`;
                    }
                    alert(output);
                } else {
                    alert(`Erro: ${data.message}`);
                }
    
                return false;
            }
        </script>
        </div>
    </div>
</body>
</html>